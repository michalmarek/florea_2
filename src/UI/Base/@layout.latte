<!DOCTYPE html>
<html lang="{$lang}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{ifset title}{$title} | {/ifset}{$shopContext->getWebsiteName()}</title>

    {* Bootstrap 5.3.3 CSS *}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<body>


{* Header with logo and main navigation *}
<header class="border-bottom mb-4">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            {* Logo (plain text for now) *}
            <a class="navbar-brand fw-bold" href="{link Home:default}">
                    {$shopContext->getWebsiteName()}
            </a>

            {* Main menu *}
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto gap-1">
                    {foreach $layoutData["mainMenu"] as $item}
                        {if count($item['children']) > 0}
                            {* Kategorie s podkategoriemi - SPLIT BUTTON *}
                            <li class="nav-item dropdown">
                                <div class="btn-group" role="group">
                                    {* Levá část - odkaz na kategorii *}
                                <a href="{link Category:default, slug => $item['category']->url}"
                                   class="btn btn-secondary">
                                    {$item['category']->name}
                                </a>

                                {* Pravá část - dropdown toggle *}
                                <button type="button"
                                    class="btn btn-secondary dropdown-toggle dropdown-toggle-split"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    <span class="visually-hidden">Toggle Dropdown</span>
                                </button>

                                {* Dropdown menu s podkategoriemi *}
                                <ul class="dropdown-menu">
                                    {foreach $item['children'] as $child}
                                        <li>
                                            <a class="dropdown-item"
                                               href="{link Category:default, slug => $child->url}">
                                                {$child->name}
                                            </a>
                                        </li>
                                    {/foreach}
                                </ul>
                            </div>
                        </li>
                    {else}
                        {* Kategorie bez podkategorií - přímý odkaz *}
                        <li class="nav-item">
                            <a class="btn btn-secondary"
                               href="{link Category:default, slug => $item['category']->url}">
                                {$item['category']->name}
                            </a>
                        </li>
                    {/if}
                {/foreach}
                </ul>
            </div>


            {* Customer Info *}
            <div class="user-menu ms-3 small">
                {if $customer->isLoggedIn}
                    Přihlášen jako: <strong>{$customer->firstName} {$customer->lastName}</strong><br>
                    <a href="{link Account:profile}">Můj účet</a> |
                    <a href="{link Auth:logout}">Odhlásit</a>
                {else}
                    Nejste přihlášen<br>
                    <a href="{link Auth:login}">Přihlásit se</a> |
                    <a href="{link Auth:register}">Registrace</a>
                {/if}
            </div>
        </div>
    </nav>
</header>


{* Flash messages *}
{if isset($flashes) && count($flashes) > 0}
    <div class="container">
        {foreach $flashes as $flash}
            <div class="alert alert-{$flash->type} alert-dismissible fade show" role="alert">
                {$flash->message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {/foreach}
    </div>
{/if}

{* Main content *}
<main class="container">
    {include content}
</main>


{* Footer *}
<footer class="border-top mt-5 py-4 text-center text-muted">
    <div class="container">
        <p class="mb-0">
            &copy; {$layoutData["footer"]->year}
            {$layoutData["footer"]->companyName}
        </p>
    </div>
</footer>

{* Bootstrap 5.3.3 JS Bundle (includes Popper) *}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>


</body>
</html>